!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{TUeX:function(e,i,o){"use strict";o.r(i),o.d(i,"ConveniosModule",function(){return st});var a=o("tyNb"),c=o("1kSV"),r=o("4NA8"),s=o("tk/3"),b=o("3Pt+"),l=o("wd/R"),u=o("vkgz"),d=o("fXoL"),m=o("ofXK");function f(t,e){1&t&&(d.Ub(0,"h3",7),d.Hc(1,"Editar documento"),d.Tb())}function v(t,e){1&t&&(d.Ub(0,"h3",7),d.Hc(1,"Nuevo documento"),d.Tb())}function h(t,e){if(1&t&&(d.Sb(0),d.Fc(1,f,2,0,"h3",6),d.Fc(2,v,2,0,"h3",6),d.Rb()),2&t){var n=d.ic();d.Cb(1),d.oc("ngIf",n.documento.id),d.Cb(1),d.oc("ngIf",!n.documento.id)}}function p(t,e){if(1&t){var n=d.Vb();d.Sb(0),d.Ub(1,"form",8),d.Ub(2,"div",9),d.Ub(3,"div",10),d.Ub(4,"label",11),d.Hc(5,"Nombre del documento"),d.Tb(),d.Pb(6,"input",12),d.Tb(),d.Tb(),d.Ub(7,"div",13),d.Ub(8,"input",14,15),d.ec("change",function(t){return d.xc(n),d.ic().onChange(t)}),d.Tb(),d.Tb(),d.Tb(),d.Rb()}if(2&t){var i=d.ic();d.Cb(1),d.oc("formGroup",i.formGroup)}}function g(t,e){if(1&t){var n=d.Vb();d.Sb(0),d.Ub(1,"button",16),d.ec("click",function(){return d.xc(n),d.ic().guardar()}),d.Hc(2,"Guardar "),d.Tb(),d.Rb()}if(2&t){var i=d.ic();d.Cb(1),d.oc("disabled",i.formGroup.invalid)}}var T,U,y,k,C=((k=function(){function e(n,i){t(this,e),this.fb=n,this.modal=i,this.passEntry=new d.n}return n(e,[{key:"ngOnInit",value:function(){this.loadForm()}},{key:"loadForm",value:function(){this.formGroup=this.fb.group({nombre:[this.documento.nombre,[b.q.required]],file:[null]})}},{key:"onChange",value:function(t){this.formGroup.patchValue({file:t.target.files[0]}),this.formGroup.get("file").updateValueAndValidity()}},{key:"guardar",value:function(){var t=this.formGroup.value;this.documento.id||(this.documento.id=Math.floor(6*Math.random()+1)),this.documento.nombre=t.nombre,this.documento.file=t.file,this.documento.tamanio=this.niceBytes(t.file.size),this.passEntry.emit(this.documento),this.modal.close(this.documento),this.formGroup.reset()}},{key:"niceBytes",value:function(t){for(var e=0,n=parseInt(t,10)||0;n>=1024&&++e;)n/=1024;return n.toFixed(n<10&&e>0?1:0)+" "+["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][e]}}]),e}()).\u0275fac=function(t){return new(t||k)(d.Ob(b.d),d.Ob(c.a))},k.\u0275cmp=d.Ib({type:k,selectors:[["app-documentacion-modal"]],inputs:{documento:"documento"},outputs:{passEntry:"passEntry"},decls:9,vars:3,consts:[[1,"modal-content"],[1,"modal-header"],[4,"ngIf"],[1,"overlay","overlay-block","cursor-default","modal-body",2,"min-height","204px"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["class","card-label",4,"ngIf"],[1,"card-label"],["action","#",1,"form","form-label-right",3,"formGroup"],[1,"form-group","row"],[1,"col-lg-12"],[1,"form-label"],["type","text","formControlName","nombre",1,"form-control","form-control-lg","form-control-solid"],[1,"form-group"],["type","file","accept","application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint,\n                    text/plain, application/pdf, image/*",3,"change"],["fileInput",""],["type","button",1,"btn","btn-primary","btn-elevate",3,"disabled","click"]],template:function(t,e){1&t&&(d.Ub(0,"div",0),d.Ub(1,"div",1),d.Fc(2,h,3,2,"ng-container",2),d.Tb(),d.Ub(3,"div",3),d.Fc(4,p,10,1,"ng-container",2),d.Tb(),d.Ub(5,"div",4),d.Ub(6,"button",5),d.ec("click",function(){return e.modal.dismiss()}),d.Hc(7,"Cancelar"),d.Tb(),d.Fc(8,g,3,1,"ng-container",2),d.Tb(),d.Tb()),2&t&&(d.Cb(2),d.oc("ngIf",e.documento),d.Cb(2),d.oc("ngIf",e.documento),d.Cb(4),d.oc("ngIf",e.documento))},directives:[m.m,b.s,b.k,b.f,b.c,b.j,b.e],styles:[""]}),k),I=((y=function(){function e(n){t(this,e),this.modal=n}return n(e,[{key:"ngOnInit",value:function(){}},{key:"eliminarConvenio",value:function(){this.modal.close()}}]),e}()).\u0275fac=function(t){return new(t||y)(d.Ob(c.a))},y.\u0275cmp=d.Ib({type:y,selectors:[["app-eliminar-convenio"]],decls:13,vars:0,consts:[[1,"modal-header"],[1,"modal-title","h4"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-elevate",3,"click"]],template:function(t,e){1&t&&(d.Ub(0,"div",0),d.Ub(1,"div",1),d.Hc(2,"Eliminar convenio"),d.Tb(),d.Tb(),d.Ub(3,"div",2),d.Ub(4,"span"),d.Hc(5,"\xbfEst\xe1s seguro de eliminar esta convenio?"),d.Tb(),d.Tb(),d.Ub(6,"div",3),d.Ub(7,"div"),d.Ub(8,"button",4),d.ec("click",function(){return e.modal.dismiss()}),d.Hc(9,"Cancelar"),d.Tb(),d.Hc(10,"\xa0 "),d.Ub(11,"button",5),d.ec("click",function(){return e.eliminarConvenio()}),d.Hc(12,"Eliminar"),d.Tb(),d.Tb(),d.Tb())},styles:[""]}),y),H=((U=function(){function e(n){t(this,e),this.modal=n}return n(e,[{key:"ngOnInit",value:function(){}},{key:"eliminarDocumento",value:function(){this.modal.close()}}]),e}()).\u0275fac=function(t){return new(t||U)(d.Ob(c.a))},U.\u0275cmp=d.Ib({type:U,selectors:[["app-eliminar-documentacion-modal"]],inputs:{id:"id"},decls:13,vars:0,consts:[[1,"modal-header"],[1,"modal-title","h4"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-elevate",3,"click"]],template:function(t,e){1&t&&(d.Ub(0,"div",0),d.Ub(1,"div",1),d.Hc(2,"Eliminar documento"),d.Tb(),d.Tb(),d.Ub(3,"div",2),d.Ub(4,"span"),d.Hc(5,"\xbfEst\xe1s seguro de eliminar este documento?"),d.Tb(),d.Tb(),d.Ub(6,"div",3),d.Ub(7,"div"),d.Ub(8,"button",4),d.ec("click",function(){return e.modal.dismiss()}),d.Hc(9,"Cancelar"),d.Tb(),d.Hc(10,"\xa0 "),d.Ub(11,"button",5),d.ec("click",function(){return e.eliminarDocumento()}),d.Hc(12,"Eliminar"),d.Tb(),d.Tb(),d.Tb())},styles:[""]}),U),w=((T=function(){function e(n){t(this,e),this.modal=n}return n(e,[{key:"ngOnInit",value:function(){}},{key:"eliminarEnlace",value:function(){this.modal.close()}}]),e}()).\u0275fac=function(t){return new(t||T)(d.Ob(c.a))},T.\u0275cmp=d.Ib({type:T,selectors:[["app-eliminar-enlace-modal"]],inputs:{id:"id"},decls:13,vars:0,consts:[[1,"modal-header"],[1,"modal-title","h4"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-elevate",3,"click"]],template:function(t,e){1&t&&(d.Ub(0,"div",0),d.Ub(1,"div",1),d.Hc(2,"Eliminar enlace"),d.Tb(),d.Tb(),d.Ub(3,"div",2),d.Ub(4,"span"),d.Hc(5,"\xbfEst\xe1s seguro de eliminar este enlace?"),d.Tb(),d.Tb(),d.Ub(6,"div",3),d.Ub(7,"div"),d.Ub(8,"button",4),d.ec("click",function(){return e.modal.dismiss()}),d.Hc(9,"Cancelar"),d.Tb(),d.Hc(10,"\xa0 "),d.Ub(11,"button",5),d.ec("click",function(){return e.eliminarEnlace()}),d.Hc(12,"Eliminar"),d.Tb(),d.Tb(),d.Tb())},styles:[""]}),T);function D(t,e){1&t&&(d.Ub(0,"h3",7),d.Hc(1,"Editar enlace"),d.Tb())}function E(t,e){1&t&&(d.Ub(0,"h3",7),d.Hc(1,"Nuevo enlace"),d.Tb())}function S(t,e){if(1&t&&(d.Sb(0),d.Fc(1,D,2,0,"h3",6),d.Fc(2,E,2,0,"h3",6),d.Rb()),2&t){var n=d.ic();d.Cb(1),d.oc("ngIf",n.enlace.id),d.Cb(1),d.oc("ngIf",!n.enlace.id)}}function x(t,e){if(1&t&&(d.Sb(0),d.Ub(1,"form",8),d.Ub(2,"div",9),d.Ub(3,"div",10),d.Ub(4,"label",11),d.Hc(5,"T\xedtulo"),d.Tb(),d.Pb(6,"input",12),d.Tb(),d.Ub(7,"div",10),d.Ub(8,"label",11),d.Hc(9,"Ruta del enlace"),d.Tb(),d.Pb(10,"input",13),d.Tb(),d.Tb(),d.Tb(),d.Rb()),2&t){var n=d.ic();d.Cb(1),d.oc("formGroup",n.formGroup)}}function G(t,e){if(1&t){var n=d.Vb();d.Sb(0),d.Ub(1,"button",14),d.ec("click",function(){return d.xc(n),d.ic().guardar()}),d.Hc(2,"Guardar "),d.Tb(),d.Rb()}if(2&t){var i=d.ic();d.Cb(1),d.oc("disabled",i.formGroup.invalid)}}var F,O=((F=function(){function e(n,i){t(this,e),this.fb=n,this.modal=i,this.passEntry=new d.n}return n(e,[{key:"ngOnInit",value:function(){this.loadForm()}},{key:"loadForm",value:function(){this.formGroup=this.fb.group({nombre:[this.enlace.nombre,[b.q.required]],url:[this.enlace.url,[b.q.required]]})}},{key:"guardar",value:function(){var t=this.formGroup.value;this.enlace.id||(this.enlace.id=Math.floor(6*Math.random()+1)),this.enlace.nombre=t.nombre,this.enlace.url=t.url,this.passEntry.emit(this.enlace),this.modal.close(this.enlace),this.formGroup.reset()}}]),e}()).\u0275fac=function(t){return new(t||F)(d.Ob(b.d),d.Ob(c.a))},F.\u0275cmp=d.Ib({type:F,selectors:[["app-enlace-modal"]],inputs:{enlace:"enlace"},outputs:{passEntry:"passEntry"},decls:9,vars:3,consts:[[1,"modal-content"],[1,"modal-header"],[4,"ngIf"],[1,"overlay","overlay-block","cursor-default","modal-body",2,"min-height","204px"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["class","card-label",4,"ngIf"],[1,"card-label"],["action","#",1,"form","form-label-right",3,"formGroup"],[1,"form-group","row"],[1,"col-lg-12"],[1,"form-label"],["type","text","formControlName","nombre",1,"form-control","form-control-lg","form-control-solid"],["type","url","pattern","https?://.+","formControlName","url",1,"form-control","form-control-lg","form-control-solid"],["type","button",1,"btn","btn-primary","btn-elevate",3,"disabled","click"]],template:function(t,e){1&t&&(d.Ub(0,"div",0),d.Ub(1,"div",1),d.Fc(2,S,3,2,"ng-container",2),d.Tb(),d.Ub(3,"div",3),d.Fc(4,x,11,1,"ng-container",2),d.Tb(),d.Ub(5,"div",4),d.Ub(6,"button",5),d.ec("click",function(){return e.modal.dismiss()}),d.Hc(7,"Cancelar"),d.Tb(),d.Fc(8,G,3,1,"ng-container",2),d.Tb(),d.Tb()),2&t&&(d.Cb(2),d.oc("ngIf",e.enlace),d.Cb(2),d.oc("ngIf",e.enlace),d.Cb(4),d.oc("ngIf",e.enlace))},directives:[m.m,b.s,b.k,b.f,b.c,b.j,b.e,b.n],styles:[""]}),F),P=o("jT/F"),V=o("5eHb"),A=o("qpnr"),B=o("dyHq"),M=o("bSwM"),R=o("e8Ap"),N=["fileInput"];function Y(t,e){if(1&t&&(d.Ub(0,"button",35),d.Pb(1,"i",36),d.Hc(2," Guardar "),d.Tb()),2&t){var n=d.ic();d.oc("disabled",n.form.invalid)}}function q(t,e){if(1&t){var n=d.Vb();d.Ub(0,"a",37),d.ec("click",function(){return d.xc(n),d.ic().editarForm()}),d.Pb(1,"i",38),d.Hc(2," Editar "),d.Tb()}}function j(t,e){if(1&t){var n=d.Vb();d.Ub(0,"a",39),d.ec("click",function(){return d.xc(n),d.ic().eliminarForm()}),d.Pb(1,"i",40),d.Hc(2," Eliminar "),d.Tb()}}function z(t,e){if(1&t){var n=d.Vb();d.Ub(0,"button",19),d.ec("click",function(){return d.xc(n),d.ic().crearDocumentacion()}),d.Pb(1,"i",41),d.Hc(2," A\xf1adir"),d.Tb()}}function $(t,e){if(1&t){var n=d.Vb();d.Ub(0,"div",47),d.Ub(1,"a",48),d.ec("click",function(){d.xc(n);var t=d.ic().$implicit;return d.ic().editarDocumento(t.id)}),d.Pb(2,"span",49),d.Tb(),d.Ub(3,"a",50),d.ec("click",function(){d.xc(n);var t=d.ic().$implicit;return d.ic().eliminarDocumento(t.id)}),d.Pb(4,"span",51),d.Tb(),d.Tb()}2&t&&(d.Cb(2),d.oc("inlineSVG","./assets/media/svg/icons/Communication/Write.svg"),d.Cb(2),d.oc("inlineSVG","./assets/media/svg/icons/General/Trash.svg"))}function L(t,e){if(1&t){var n=d.Vb();d.Ub(0,"tr"),d.Ub(1,"td"),d.Hc(2),d.Tb(),d.Ub(3,"td"),d.Ub(4,"div",42),d.Ub(5,"a",43),d.ec("click",function(){d.xc(n);var t=e.$implicit;return d.ic().download(t.url,t.original)}),d.Hc(6),d.Tb(),d.Ub(7,"a",44),d.ec("click",function(){d.xc(n);var t=e.$implicit;return d.ic().download(t.url,t.original)}),d.Pb(8,"i",45),d.Tb(),d.Tb(),d.Tb(),d.Ub(9,"td"),d.Hc(10),d.Tb(),d.Ub(11,"td"),d.Fc(12,$,5,2,"div",46),d.Tb(),d.Tb()}if(2&t){var i=e.$implicit,o=d.ic();d.Cb(2),d.Ic(i.nombre),d.Cb(4),d.Ic(i.original),d.Cb(4),d.Ic(i.tamanio),d.Cb(2),d.oc("ngIf",o.mostrarBotonesGeneral)}}function _(t,e){if(1&t){var n=d.Vb();d.Ub(0,"div",10),d.Ub(1,"div",24),d.Ub(2,"div",12),d.Ub(3,"input",52,53),d.ec("change",function(t){return d.xc(n),d.ic().onUpload(t)}),d.Tb(),d.Tb(),d.Tb(),d.Ub(5,"div",54),d.Ub(6,"div",55),d.Pb(7,"img",56),d.Ub(8,"a",57),d.ec("click",function(){d.xc(n);var t=d.wc(4);return d.ic().reset(t)}),d.Pb(9,"i",40),d.Tb(),d.Tb(),d.Tb(),d.Tb()}if(2&t){var i=d.ic();d.Cb(6),d.oc("className",i.mostrarImagen?"mostrarImagenArea":"ocultarImagenArea"),d.Cb(1),d.oc("src",i.imagePath,d.zc)}}function W(t,e){if(1&t&&(d.Ub(0,"div",10),d.Ub(1,"div",54),d.Ub(2,"div",55),d.Pb(3,"img",58),d.Tb(),d.Tb(),d.Tb()),2&t){var n=d.ic();d.Cb(2),d.oc("className",n.mostrarImagen?"mostrarImagenArea":"ocultarImagenArea"),d.Cb(1),d.oc("src",n.imagePath,d.zc)}}function J(t,e){if(1&t){var n=d.Vb();d.Ub(0,"button",19),d.ec("click",function(){return d.xc(n),d.ic().crearEnlace()}),d.Pb(1,"i",41),d.Hc(2," A\xf1adir"),d.Tb()}}function K(t,e){if(1&t){var n=d.Vb();d.Ub(0,"div",47),d.Ub(1,"a",60),d.ec("click",function(){d.xc(n);var t=d.ic().$implicit;return d.ic().editarEnlace(t.id)}),d.Pb(2,"span",49),d.Tb(),d.Ub(3,"a",61),d.ec("click",function(){d.xc(n);var t=d.ic().$implicit;return d.ic().eliminarEnlace(t.id)}),d.Pb(4,"span",51),d.Tb(),d.Tb()}2&t&&(d.Cb(2),d.oc("inlineSVG","./assets/media/svg/icons/Communication/Write.svg"),d.Cb(2),d.oc("inlineSVG","./assets/media/svg/icons/General/Trash.svg"))}function X(t,e){if(1&t&&(d.Ub(0,"tr"),d.Ub(1,"td"),d.Hc(2),d.Tb(),d.Ub(3,"td"),d.Ub(4,"a",59),d.Hc(5),d.Tb(),d.Tb(),d.Ub(6,"td"),d.Fc(7,K,5,2,"div",46),d.Tb(),d.Tb()),2&t){var n=e.$implicit,i=d.ic();d.Cb(2),d.Ic(n.nombre),d.Cb(2),d.pc("href",n.url,d.zc),d.Cb(1),d.Ic(n.url),d.Cb(2),d.oc("ngIf",i.mostrarBotonesGeneral)}}var Q,Z=((Q=function(){function e(n,i,o,a,c,r,s,b){t(this,e),this.formBuilder=n,this.activatedRouter=i,this.router=o,this.uploadService=a,this.ref=c,this.toastr=r,this.modalService=s,this.conveniosService=b,this.disabledCampos=!0,this.mostrarBotonesGeneral=!0,this.mostrarBotonEdit=!0,this.mostrarBotonDelete=!1,this.currentDate=new Date,this.base64textString="",this.imagePath="",this.mostrarImagen=!1,this.listEnlaces=[],this.listDocumentacion=[]}return n(e,[{key:"ngOnInit",value:function(){var t=this;if(this.idConvenio=this.activatedRouter.snapshot.paramMap.get("id"),this.isAddMode=!this.idConvenio,this.isAddMode?(this.disabledCampos=!1,this.mostrarBotonEdit=!1):this.mostrarBotonesGeneral=!1,this.form=this.formBuilder.group({id:0,titulo:[{value:"",disabled:this.disabledCampos},[b.q.required]],fechaAlta:[{value:null,disabled:!0},[b.q.required]],mostrar:[{value:null,disabled:this.disabledCampos}],texto:[{value:"",disabled:this.disabledCampos},[b.q.required]],file:[null],imagenServidor:[null]}),this.isAddMode){var e={year:this.currentDate.getFullYear(),month:this.currentDate.getMonth()+1,day:this.currentDate.getDate()};this.form.patchValue({fechaAlta:e})}else this.conveniosService.getById(this.idConvenio).pipe(Object(u.a)(function(e){return t.mostrarDatosAlEditar(e)})).subscribe(function(e){return t.form.patchValue({titulo:e.titulo,mostrar:e.mostrar,texto:e.texto,fechaAlta:{year:new Date(l(e.fechaAlta).format("YYYY-MM-DD HH:mm:ss")).getFullYear(),month:new Date(l(e.fechaAlta).format("YYYY-MM-DD HH:mm:ss")).getMonth(),day:new Date(l(e.fechaAlta).format("YYYY-MM-DD HH:mm:ss")).getDate()}})})}},{key:"mostrarDatosAlEditar",value:function(t){this.convenio=t,this.mostrarImagen=!0,this.imagePath=this.convenio.imagenServidorBase64,this.listEnlaces=this.convenio.listEnlaces,this.listDocumentacion=this.convenio.listDocumentos}},{key:"editarForm",value:function(){this.mostrarBotonesGeneral=!0,this.mostrarBotonEdit=!1,this.mostrarBotonDelete=!0,this.form.get("titulo").enable(),this.form.get("mostrar").enable(),this.form.get("texto").enable()}},{key:"ngOnDestroy",value:function(){this.suscription&&this.suscription.unsubscribe()}},{key:"guardarConvenio",value:function(){var t,e,n,i,o=this,a=!0,c={id:null!=this.convenio?this.convenio.id:0,titulo:null===(t=this.form.get("titulo"))||void 0===t?void 0:t.value,fechaAlta:l.utc(null===(e=this.form.get("fechaAlta"))||void 0===e?void 0:e.value),mostrar:null!=this.form.get("mostrar")&&this.form.get("mostrar").value,texto:null===(n=this.form.get("texto"))||void 0===n?void 0:n.value,file:null===(i=this.form.get("file"))||void 0===i?void 0:i.value,imagenServidor:this.form.get("imagenServidor").value,listEnlaces:this.listEnlaces,listDocumentos:this.listDocumentacion};this.isAddMode&&null==c.file&&(this.toastr.error("Inserte una imagen","Error"),a=!1),a&&(this.isAddMode?this.conveniosService.aniadirConvenio(c).subscribe(function(t){o.toastr.success("Convenio guardado","Convenio"),o.router.navigate(["/admin/convenio/gestion/"+t.id])}):this.conveniosService.modificarConvenio(c).subscribe(function(t){o.toastr.success("Convenio guardado","Convenio"),o.myInputVariable.nativeElement.value="",o.mostrarImagen=!1,o.listEnlaces=null,o.listDocumentacion=null,o.mostrarBotonEdit=!0,o.mostrarBotonDelete=!1,o.form.get("titulo").disable(),o.form.get("mostrar").disable(),o.form.get("texto").disable(),o.ref.detectChanges(),o.form.reset(),o.ngOnInit()}))}},{key:"eliminarForm",value:function(){var t=this;this.modalService.open(I,{size:"lg"}).result.then(function(e){t.conveniosService.eliminarConvenio(t.convenio.id).subscribe(function(e){t.router.navigate(["/admin/convenio/listado/"]),t.toastr.error("Convenio borrado","Convenio")})}).catch(function(t){console.log(t)})}},{key:"crearDocumentacion",value:function(){this.editarDocumento(void 0)}},{key:"editarDocumento",value:function(t){var e=this,n=this.modalService.open(C,{size:"lg"});if(null!=t){var i=this.listDocumentacion.find(function(e){return e.id===t});n.componentInstance.documento={id:i.id,nombre:i.nombre}}else n.componentInstance.documento={id:void 0,nombre:""};n.result.then(function(n){if(n){var i=e.listDocumentacion.findIndex(function(e){return e.id===t});i>-1&&e.listDocumentacion.splice(i,1),e.subirDocAlta(n)}}).catch(function(t){console.log(t)})}},{key:"subirDocAlta",value:function(t){var e=this;this.uploadService.uploadDocumento(t.file).subscribe(function(n){switch(n.type){case s.e.Sent:console.log("Request has been made!");break;case s.e.ResponseHeader:console.log("Response header has been received!");break;case s.e.UploadProgress:break;case s.e.Response:t.url=n.body.url,t.servidor=n.body.fileName,t.original=t.file.name,e.listDocumentacion.push(t),e.ref.detectChanges()}})}},{key:"download",value:function(t,e){this.uploadService.download(t).subscribe(function(t){var n=new Blob([t],{type:"application/pdf"}),i=window.URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=e,o.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout(function(){window.URL.revokeObjectURL(i),o.remove()},100)})}},{key:"eliminarDocumento",value:function(t){var e=this,n=this.modalService.open(H,{size:"lg"});n.componentInstance.id=t,n.result.then(function(n){var i=e.listDocumentacion.findIndex(function(e){return e.id===t});i>-1&&e.listDocumentacion.splice(i,1),e.ref.detectChanges()}).catch(function(t){console.log(t)})}},{key:"onUpload",value:function(t){var e=this;this.form.patchValue({file:t.target.files[0]}),this.form.get("file").updateValueAndValidity(),this.uploadService.uploadImagen(this.form.value.file).subscribe(function(t){switch(t.type){case s.e.Sent:console.log("Request has been made!");break;case s.e.ResponseHeader:console.log("Response header has been received!");break;case s.e.UploadProgress:break;case s.e.Response:var n=new FileReader;n.onload=e._handleReaderLoaded.bind(e),n.readAsBinaryString(e.form.value.file),e.form.patchValue({imagenServidor:t.body.fileName}),e.form.get("imagenServidor").updateValueAndValidity()}})}},{key:"_handleReaderLoaded",value:function(t){this.base64textString=btoa(t.target.result),this.imagePath="data:image/png;base64,"+this.base64textString,this.mostrarImagen=!0,this.ref.detectChanges()}},{key:"reset",value:function(t){this.mostrarImagen=!1,this.form.patchValue({file:null}),t.value=""}},{key:"crearEnlace",value:function(){this.editarEnlace(void 0)}},{key:"editarEnlace",value:function(t){var e=this,n=this.modalService.open(O,{size:"lg"});if(null!=t){var i=this.listEnlaces.find(function(e){return e.id===t});n.componentInstance.enlace={id:i.id,nombre:i.nombre,url:i.url}}else n.componentInstance.enlace={id:void 0,nombre:"",url:""};n.result.then(function(n){if(n){var i=e.listEnlaces.findIndex(function(e){return e.id===t});i>-1&&e.listEnlaces.splice(i,1),e.listEnlaces.push(n),e.ref.detectChanges()}}).catch(function(t){console.log(t)})}},{key:"eliminarEnlace",value:function(t){var e=this,n=this.modalService.open(w,{size:"lg"});n.componentInstance.id=t,n.result.then(function(n){var i=e.listEnlaces.findIndex(function(e){return e.id===t});i>-1&&e.listEnlaces.splice(i,1),e.ref.detectChanges()}).catch(function(t){console.log(t)})}}]),e}()).\u0275fac=function(t){return new(t||Q)(d.Ob(b.d),d.Ob(a.a),d.Ob(a.h),d.Ob(P.a),d.Ob(d.h),d.Ob(V.b),d.Ob(c.i),d.Ob(A.a))},Q.\u0275cmp=d.Ib({type:Q,selectors:[["app-nuevo"]],viewQuery:function(t,e){var n;1&t&&d.Mc(N,!0),2&t&&d.vc(n=d.fc())&&(e.myInputVariable=n.first)},decls:96,vars:10,consts:[["id","kt_form",1,"form",3,"formGroup","ngSubmit"],[1,"text-right"],["class","btn btn-success ","type","submit","name","btn-guardar",3,"disabled",4,"ngIf"],["class","btn btn-info ","name","btn-editar",3,"click",4,"ngIf"],["class","btn btn-danger ml-2","name","btn-eliminar",3,"click",4,"ngIf"],[1,"card","card-custom","gutter-b"],[1,"card-header"],[1,"card-title","mb-0","text-right"],[1,"card-body"],["data-wizard-type","step-content","data-wizard-state","current",1,"pb-5"],[1,"row"],[1,"col-md-12"],[1,"form-group"],["type","text","formControlName","titulo","placeholder","T\xedtulo de la actividad",1,"form-control"],[1,"col-md-3"],[1,"input-group"],["placeholder","dd-mm-yyyy","name","dp","ngbDatepicker","","formControlName","fechaAlta",1,"form-control"],["d","ngbDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-calendar"],[1,"form-group","mt-0","mt-md-10"],["formControlName","mostrar",1,"example-margin"],["rows","5","formControlName","texto","placeholder","Descripci\xf3n del convenio",1,"form-control"],[1,"col-12"],[1,"card-title"],[1,"card-label"],[1,"card-toolbar"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],[1,"table-responsive","angular-bootstrap-table"],[1,"table","table-head-custom","table-vertical-center","overflow-hidden"],[4,"ngFor","ngForOf"],[1,"col-12","col-md-5"],["class","row",4,"ngIf"],[1,"col-12","col-md-7"],["type","submit","name","btn-guardar",1,"btn","btn-success",3,"disabled"],[1,"fa","fa-check"],["name","btn-editar",1,"btn","btn-info",3,"click"],[1,"fa","fa-edit"],["name","btn-eliminar",1,"btn","btn-danger","ml-2",3,"click"],[1,"fa","fa-trash"],[1,"fa","fa-plus"],["role","group",1,"btn-group","btn-group-sm"],["title","","target","_blank",1,"btn","btn-outline-success",3,"click"],["title","",1,"btn","btn-outline-success",3,"click"],[1,"fa","fa-download"],["class","text-center accion",4,"ngIf"],[1,"text-center","accion"],["title","Editar documento",1,"btn","btn-icon","btn-light","btn-hover-primary","btn-sm","mx-3",3,"click"],["cacheSVG","true",1,"svg-icon","svg-icon-md","svg-icon-primary",3,"inlineSVG"],["title","Eliminar documento",1,"btn","btn-icon","btn-light","btn-hover-danger","btn-sm",3,"click"],["cacheSVG","true",1,"svg-icon","svg-icon-md","svg-icon-danger",3,"inlineSVG"],["type","file","accept","image/*",3,"change"],["fileInput",""],[1,"col-12","text-center"],[3,"className"],["id","imagen-subida",1,"img-responsive","img-container",2,"max-width","100%",3,"src"],[1,"btn","btn-danger","btn-eliminar-img",3,"click"],["id","imagen-subida",1,"img-responsive",2,"max-width","100%",3,"src"],["target","_blank",3,"href"],["title","Edit enlace",1,"btn","btn-icon","btn-light","btn-hover-primary","btn-sm","mx-3",3,"click"],["title","Eliminar enlace",1,"btn","btn-icon","btn-light","btn-hover-danger","btn-sm",3,"click"]],template:function(t,e){if(1&t){var n=d.Vb();d.Ub(0,"form",0),d.ec("ngSubmit",function(){return e.guardarConvenio()}),d.Ub(1,"app-notice",1),d.Fc(2,Y,3,1,"button",2),d.Fc(3,q,3,0,"a",3),d.Fc(4,j,3,0,"a",4),d.Tb(),d.Ub(5,"div",5),d.Ub(6,"div",6),d.Ub(7,"div",7),d.Ub(8,"p"),d.Hc(9,"Informaci\xf3n del convenio"),d.Tb(),d.Tb(),d.Tb(),d.Ub(10,"div",8),d.Ub(11,"div",9),d.Ub(12,"div",10),d.Ub(13,"div",11),d.Ub(14,"div",12),d.Ub(15,"label"),d.Hc(16,"T\xedtulo"),d.Tb(),d.Pb(17,"input",13),d.Tb(),d.Tb(),d.Ub(18,"div",14),d.Ub(19,"div",12),d.Ub(20,"label"),d.Hc(21,"Fecha Alta"),d.Tb(),d.Ub(22,"div",15),d.Pb(23,"input",16,17),d.Ub(25,"div",18),d.Ub(26,"button",19),d.ec("click",function(){return d.xc(n),d.wc(24).toggle()}),d.Pb(27,"i",20),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Ub(28,"div",14),d.Ub(29,"div",21),d.Ub(30,"mat-checkbox",22),d.Hc(31,"Mostrar en la web"),d.Tb(),d.Tb(),d.Tb(),d.Ub(32,"div",11),d.Ub(33,"div",12),d.Ub(34,"label"),d.Hc(35,"Descripci\xf3n"),d.Tb(),d.Pb(36,"textarea",23),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Ub(37,"div",10),d.Ub(38,"div",24),d.Ub(39,"div",5),d.Ub(40,"div",6),d.Ub(41,"div",25),d.Ub(42,"h3",26),d.Hc(43,"Documentaci\xf3n"),d.Tb(),d.Tb(),d.Ub(44,"div",27),d.Fc(45,z,3,0,"button",28),d.Tb(),d.Tb(),d.Ub(46,"div",8),d.Ub(47,"div",9),d.Ub(48,"div",10),d.Ub(49,"div",24),d.Ub(50,"div",29),d.Ub(51,"table",30),d.Ub(52,"thead"),d.Ub(53,"tr"),d.Ub(54,"th"),d.Hc(55,"Nombre"),d.Tb(),d.Ub(56,"th"),d.Hc(57,"Original"),d.Tb(),d.Ub(58,"th"),d.Hc(59,"Tama\xf1o"),d.Tb(),d.Pb(60,"th"),d.Tb(),d.Tb(),d.Ub(61,"tbody"),d.Fc(62,L,13,4,"tr",31),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Ub(63,"div",32),d.Ub(64,"div",5),d.Ub(65,"div",6),d.Ub(66,"div",7),d.Ub(67,"p"),d.Hc(68,"Imagen"),d.Tb(),d.Tb(),d.Tb(),d.Ub(69,"div",8),d.Ub(70,"div",9),d.Fc(71,_,10,2,"div",33),d.Fc(72,W,4,2,"div",33),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Ub(73,"div",34),d.Ub(74,"div",5),d.Ub(75,"div",6),d.Ub(76,"div",25),d.Ub(77,"h3",26),d.Hc(78,"Enlaces"),d.Tb(),d.Tb(),d.Ub(79,"div",27),d.Fc(80,J,3,0,"button",28),d.Tb(),d.Tb(),d.Ub(81,"div",8),d.Ub(82,"div",9),d.Ub(83,"div",10),d.Ub(84,"div",24),d.Ub(85,"div",29),d.Ub(86,"table",30),d.Ub(87,"thead"),d.Ub(88,"tr"),d.Ub(89,"th"),d.Hc(90,"Nombre"),d.Tb(),d.Ub(91,"th"),d.Hc(92,"Ruta"),d.Tb(),d.Pb(93,"th"),d.Tb(),d.Tb(),d.Ub(94,"tbody"),d.Fc(95,X,8,4,"tr",31),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb()}2&t&&(d.oc("formGroup",e.form),d.Cb(2),d.oc("ngIf",e.mostrarBotonesGeneral),d.Cb(1),d.oc("ngIf",e.mostrarBotonEdit),d.Cb(1),d.oc("ngIf",e.mostrarBotonDelete),d.Cb(41),d.oc("ngIf",e.mostrarBotonesGeneral),d.Cb(17),d.oc("ngForOf",e.listDocumentacion),d.Cb(9),d.oc("ngIf",e.mostrarBotonesGeneral),d.Cb(1),d.oc("ngIf",!e.mostrarBotonesGeneral),d.Cb(8),d.oc("ngIf",e.mostrarBotonesGeneral),d.Cb(15),d.oc("ngForOf",e.listEnlaces))},directives:[b.s,b.k,b.f,B.a,m.m,b.c,b.j,b.e,c.h,M.a,m.l,R.a],styles:[".ocultarImagenArea[_ngcontent-%COMP%]{display:none}.mostrarImagenArea[_ngcontent-%COMP%]{display:block;margin:10px;height:auto;overflow:auto}.btn-eliminar-img[_ngcontent-%COMP%]{position:absolute;left:89%;bottom:-2%;transform:translate(-50%,-50%)}.accion[_ngcontent-%COMP%]{justify-content:space-between}"]}),Q),tt=o("+H98"),et=o("KSW3");function nt(t,e){if(1&t){var n=d.Vb();d.Ub(0,"tr"),d.Ub(1,"td"),d.Hc(2),d.Tb(),d.Ub(3,"td"),d.Hc(4),d.jc(5,"date"),d.Tb(),d.Ub(6,"td"),d.Hc(7),d.Tb(),d.Ub(8,"td"),d.Hc(9),d.Tb(),d.Ub(10,"td",16),d.Ub(11,"a",17),d.ec("click",function(){d.xc(n);var t=e.$implicit;return d.ic().editarConvenio(t.id)}),d.Pb(12,"span",18),d.Tb(),d.Tb(),d.Tb()}if(2&t){var i=e.$implicit,o=d.ic();d.Cb(2),d.Ic(i.id),d.Cb(2),d.Ic(d.lc(5,5,o.convertDate(i.fechaAlta),"dd/MM/yyyy")),d.Cb(3),d.Ic(i.titulo),d.Cb(2),d.Ic(i.mostrar?"Si":"No"),d.Cb(3),d.oc("inlineSVG","./assets/media/svg/icons/Communication/Write.svg")}}var it,ot,at=((it=function(){function e(n,i,o,a){t(this,e),this.fb=n,this.router=i,this.ref=o,this.conveniosService=a,this.subscriptions=[]}return n(e,[{key:"ngOnInit",value:function(){var t=this;this.filterForm(),this.conveniosService.fetch(),this.paginator=this.conveniosService.paginator,this.sorting=this.conveniosService.sorting;var e=this.conveniosService.isLoading$.subscribe(function(e){return t.isLoading=e});this.subscriptions.push(e)}},{key:"editarConvenio",value:function(t){this.router.navigate(["/admin/convenio/gestion/"+t])}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})}},{key:"convertDate",value:function(t){return null!=t?new Date(l(t).add(-1,"M").format("YYYY-MM-DD HH:mm:ss")):null}},{key:"filterForm",value:function(){var t=this;this.filterGroup=this.fb.group({status:[""],type:[""],searchTerm:[""]}),this.subscriptions.push(this.filterGroup.controls.status.valueChanges.subscribe(function(){return t.filter()})),this.subscriptions.push(this.filterGroup.controls.type.valueChanges.subscribe(function(){return t.filter()}))}},{key:"filter",value:function(){var t={},e=this.filterGroup.get("status").value;e&&(t.mostrar=e);var n=this.filterGroup.get("type").value;n&&(t.type=n),this.conveniosService.patchState({filter:t})}},{key:"sort",value:function(t){var e=this.sorting;e.column===t?e.direction="asc"===e.direction?"desc":"asc":(e.column=t,e.direction="asc"),this.conveniosService.patchState({sorting:e})}},{key:"paginate",value:function(t){this.conveniosService.patchState({paginator:t})}}]),e}()).\u0275fac=function(t){return new(t||it)(d.Ob(b.d),d.Ob(a.h),d.Ob(d.h),d.Ob(A.a))},it.\u0275cmp=d.Ib({type:it,selectors:[["app-listado"]],decls:32,vars:12,consts:[[1,"row"],[1,"col-12"],[1,"card","card-custom","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],["data-wizard-type","step-content","data-wizard-state","current",1,"pb-5"],[1,"table-responsive","angular-bootstrap-table"],[1,"table","table-head-custom","table-vertical-center","overflow-hidden"],["column","id",3,"activeColumn","activeDirection","sort"],["column","fechaAlta",3,"activeColumn","activeDirection","sort"],["column","titulo",3,"activeColumn","activeDirection","sort"],["column","mostrar",3,"activeColumn","activeDirection","sort"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","flex-wrap",3,"paginator","paginate"],[1,"text-center","accion"],["title","Edit enlace",1,"btn","btn-icon","btn-light","btn-hover-primary","btn-sm","mx-3",3,"click"],["cacheSVG","true",1,"svg-icon","svg-icon-md","svg-icon-primary",3,"inlineSVG"]],template:function(t,e){1&t&&(d.Ub(0,"div",0),d.Ub(1,"div",1),d.Ub(2,"div",2),d.Ub(3,"div",3),d.Ub(4,"div",4),d.Ub(5,"h3",5),d.Hc(6,"Listado de convenios"),d.Tb(),d.Tb(),d.Tb(),d.Ub(7,"div",6),d.Ub(8,"div",7),d.Ub(9,"div",0),d.Ub(10,"div",1),d.Ub(11,"div",8),d.Ub(12,"table",9),d.Ub(13,"thead"),d.Ub(14,"tr"),d.Ub(15,"th"),d.Hc(16," Id "),d.Ub(17,"app-sort-icon",10),d.ec("sort",function(t){return e.sort(t)}),d.Tb(),d.Tb(),d.Ub(18,"th"),d.Hc(19," Fecha Alta "),d.Ub(20,"app-sort-icon",11),d.ec("sort",function(t){return e.sort(t)}),d.Tb(),d.Tb(),d.Ub(21,"th"),d.Hc(22," T\xedtulo "),d.Ub(23,"app-sort-icon",12),d.ec("sort",function(t){return e.sort(t)}),d.Tb(),d.Tb(),d.Ub(24,"th"),d.Hc(25," Mostrar "),d.Ub(26,"app-sort-icon",13),d.ec("sort",function(t){return e.sort(t)}),d.Tb(),d.Tb(),d.Pb(27,"th"),d.Tb(),d.Tb(),d.Ub(28,"tbody"),d.Fc(29,nt,13,8,"tr",14),d.jc(30,"async"),d.Tb(),d.Tb(),d.Tb(),d.Ub(31,"app-paginator",15),d.ec("paginate",function(t){return e.paginate(t)}),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb()),2&t&&(d.Cb(17),d.oc("activeColumn",e.sorting.column)("activeDirection",e.sorting.direction),d.Cb(3),d.oc("activeColumn",e.sorting.column)("activeDirection",e.sorting.direction),d.Cb(3),d.oc("activeColumn",e.sorting.column)("activeDirection",e.sorting.direction),d.Cb(3),d.oc("activeColumn",e.sorting.column)("activeDirection",e.sorting.direction),d.Cb(3),d.oc("ngForOf",d.kc(30,10,e.conveniosService.items$)),d.Cb(2),d.oc("paginator",e.paginator))},directives:[tt.a,m.l,et.a,R.a],pipes:[m.b,m.e],styles:[""]}),it),ct=o("PTxQ"),rt=o("BJ2y"),st=((ot=function e(){t(this,e)}).\u0275mod=d.Mb({type:ot}),ot.\u0275inj=d.Lb({factory:function(t){return new(t||ot)},providers:[{provide:c.c,useClass:r.a}],imports:[[a.l.forChild([{path:"nuevo",component:Z},{path:"gestion/:id",component:Z},{path:"listado",component:at}]),m.c,c.j,M.b,ct.a,R.b,rt.a,b.g,b.o]]}),ot)}}])}();